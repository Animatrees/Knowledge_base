БД и СУБД

SQL (Structured Query Language)

ORM (Object-Relational Mapping)

Django ORM

Настройка используемой СУБД в Django

Модели

Часто используемые типы полей

Часто используемые аргументы полей

### БД и СУБД

**База данных** - это организованная коллекция данных, которая обычно хранится в электронном виде на компьютере или сервере. Она предназначена для эффективного хранения, управления и доступа к информации.

Базы данных используются для сохранения и извлечения данных из приложений, обеспечивая централизованное хранилище для информации, которую могут использовать различные части приложений.

**Реляционная база данных** – это тип базы данных, организованный в соответствии с принципами реляционной модели данных, предложенной Эдгаром Коддом в 1970 году.

[![](https://cf.ppt-online.org/files/slide/5/5HEt9hl1Wg0ujdfBxqOk3A6soprFP7anbzVDS8/slide.jpg)](https://cf.ppt-online.org/files/slide/5/5HEt9hl1Wg0ujdfBxqOk3A6soprFP7anbzVDS8/slide.jpg)

**Основные характеристики:**

- **Данные организованы в виде таблиц**, состоящих из столбцов (атрибутов) и строк (записей).
- **Отношения между таблицами** создаются с использованием ключей. Ключи могут быть первичными (уникальными идентификаторами записей в таблице) или внешними (связывающими записи между разными таблицами).
- **Язык запросов SQL** используется для управления данными (добавление, изменение, удаление, выборка).
- **Обеспечивается целостность данных**, то есть их точность, полнота и согласованность.

- _Краткий обзор типов баз данных._
    
    **1. Реляционные базы данных:**
    
    - Наиболее распространенный тип.
    - Данные организованы в виде таблиц.
    - Подходят для OLTP (онлайн-обработка транзакций).
    - Примеры: MySQL, PostgreSQL, Oracle, Microsoft SQL Server.
    
    **2. NoSQL базы данных:**
    
    - Не реляционные базы данных.
    - Подходят для хранения неструктурированных данных.
    - Различные типы NoSQL:
        - Ключ-значение: Redis, Memcached.
        - Документо-ориентированные: MongoDB, CouchDB.
        - Колоночные: Cassandra, HBase.
        - Графовые: Neo4j, Titan.
    
    **3. OLAP базы данных:**
    
    - Предназначены для аналитической обработки данных.
    - Оптимизированы для сложных запросов.
    - Примеры: Google BigQuery, Amazon Redshift, Snowflake.
    
    **4. Временные ряды:**
    
    - Хранят данные, изменяющиеся во времени.
    - Подходят для анализа тенденций и прогнозирования.
    - Примеры: InfluxDB, Prometheus, TimescaleDB.
    
    **5. Кэширование:**
    
    - Хранят часто используемые данные для быстрого доступа.
    - Уменьшают нагрузку на основную базу данных.
    - Примеры: Redis, Memcached.
    
    **6. Геопространственные:**
    
    - Хранят пространственные данные (точки, линии, полигоны).
    - Используются для ГИС (геоинформационные системы).
    - Примеры: PostGIS, MongoDB Geospatial, Spatialite.
    
    **7. Текстовые:**
    
    - Оптимизированы для хранения и поиска текстовых данных.
    - Используются для полнотекстового поиска.
    - Примеры: Elasticsearch, Solr, Apache Lucene.

  

**СУБД** (система управления базами данных) и **база данных** (БД) – это два тесно связанных, но не взаимозаменяемых понятия.

**СУБД** – это программное обеспечение, которое позволяет управлять базой данных. СУБД выполняет следующие функции:

- Создание и изменение структуры БД.
- Добавление, изменение и удаление данных.
- Выполнение запросов к БД.
- Обеспечение безопасности данных.
- Предоставление доступа к данным пользователям.

Таким образом, база данных – это сами данные, а СУБД – это инструмент для работы с этими данными.

**Django поддерживает следующие реляционные СУБД:**

- PostgreSQL
- MariaDB
- MySQL
- Oracle
- SQLite

### **SQL** (Structured Query Language)

**SQL** – это язык структурированных запросов, предназначенный для работы с реляционными базами данных.

**Основные возможности:**

- Создание, изменение и удаление таблиц и данных.
- Выборка данных из одной или нескольких таблиц по заданным критериям.
- Сортировка и фильтрация данных.
- Агрегирование данных (вычисление сумм, средних значений, и т.д.).
- Создание и управление связями между таблицами.
- Предоставление доступа к данным пользователям.

### **ORM (Object-Relational Mapping)**

**ORM** – это технология программирования, которая связывает объектно-ориентированные языки программирования с реляционными базами данных. ORM позволяет работать с данными в БД с помощью объектов, что упрощает и ускоряет разработку.

**Основные концепции ORM:**

1. **Отображение объектов:** ORM позволяет создавать классы в объектно-ориентированном коде, которые отображают таблицы и их отношения в базе данных. Каждый объект класса соответствует записи в таблице.
2. **Автоматическое создание запросов:** ORM автоматически генерирует SQL-запросы для выполнения операций, таких как выборка, вставка, обновление и удаление данных из базы данных.
3. **Отношения между объектами:** ORM позволяет определять и управлять отношениями между объектами, отражая связи между таблицами в базе данных.
4. **Объектно-ориентированный код:** Программисты работают с объектами и классами, а не с языком SQL и таблицами баз данных, что делает код более понятным и поддерживаемым.

### Django ORM

[![](https://miro.medium.com/v2/resize:fit:1400/1*AQO6jWZjltyzE7TSO4DPEQ.png)](https://miro.medium.com/v2/resize:fit:1400/1*AQO6jWZjltyzE7TSO4DPEQ.png)

**Django ORM** – это инструмент, который позволяет работать с данными в реляционных базах данных из Python-кода. ORM представляет собой слой абстракции, который скрывает от разработчика детали реализации SQL-запросов.

**Основные возможности Django ORM:**

- **Определение моделей данных:**  
    В файле  
    `models.py` описываются модели данных, которые будут использоваться в приложении. Модели представляют собой классы Python, которые соответствуют таблицам в БД.
- **Миграции:**  
    Django использует систему миграций для синхронизации структуры БД с моделями. При внесении изменений в модели Django автоматически генерирует SQL-запросы для обновления БД.  
    
- **Работа с данными:**  
    Django ORM предоставляет API для выполнения CRUD-операций (Create, Read, Update, Delete) с данными в БД.  
    
- **Запросы:**  
    Django ORM позволяет создавать сложные запросы к БД с помощью Python-кода.  
    
- **Оптимизация**:
    
    Оптимизирует запросы по скорости выполнения и частоте запросов к БД.
    
- **Защита**:
    
    Обеспечивает защиту от SQL-инъекций.
    

### Настройка используемой СУБД в Django

Настройка используемой базы данных осуществляется через файл конфигурации `settings.py`, который находится в корневой директории проекта. В этом файле, используя переменную `DATABASES`, можно определить параметры подключения к базе данных, такие как тип базы данных, имя базы данных, пользователь, пароль и т. д.

По умолчанию используется SQLite3 СУБД.

**Пример**:

```Python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'mydatabase',
        'USER': 'mydatabaseuser',
        'PASSWORD': 'mypassword',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}
```

1. `**'ENGINE': 'django.db.backends.postgresql'**`:
    - Определяет используемый движок базы данных.  
        В данном случае, указывает, что Django будет использовать PostgreSQL.  
        
2. `**'NAME': 'mydatabase'**`:
    - Указывает имя базы данных, с которой Django будет взаимодействовать.  
        В данном примере это  
        `'mydatabase'`.
3. `**'USER': 'mydatabaseuser'**`:
    - Это имя пользователя, который будет использоваться для подключения к базе данных PostgreSQL.
4. **'**`**PASSWORD': 'mypassword'**`:
    - Пароль пользователя базы данных, который будет использоваться для аутентификации при подключении.
5. `**'HOST': 'localhost'**`:
    - Указывает хост базы данных, к которому будет устанавливаться соединение.  
        В данном случае это  
        `'localhost'`, что означает, что база данных размещена на том же сервере, где работает Django.
6. `**'PORT': '5432'**`:
    - Это порт, на котором слушает база данных PostgreSQL.  
        По умолчанию для PostgreSQL используется порт 5432.  
        

### Модели

**Модели** в Django – это краеугольный камень фреймворка. Они представляют собой слои абстракции, которые:

- Определяют структуру данных, хранящихся в базе данных (БД).
- Связывают данные между собой.
- Предоставляют API для работы с данными.

**Основные концепции моделей в Django включают:**

1. **Определение модели:** Модели определяются в файлах `models.py` внутри приложений. Каждая модель обычно представляет собой класс, который наследуется от базового класса `django.db.models.Model`.  
    Каждый экземпляр класса модели будет представлять собой запись из таблицы БД.  
    
2. **Поля (Fields):** Атрибуты модели представляют собой поля, которые определяют структуру данных. Django предоставляет множество встроенных полей, таких как `CharField`, `IntegerField`, `DateTimeField` и другие, а также возможность определения пользовательских полей.
3. **Операции с данными:** Модели Django позволяют разработчикам выполнять различные операции с данными.
4. **Связи между моделями:** Модели могут иметь связи друг с другом, определяющие отношения между различными типами данных. Django поддерживает различные типы связей, такие как один-к-одному, один-ко-многим и многие-ко-многим.
5. **Методы и атрибуты модели:** Разработчики могут определять методы и атрибуты в моделях, чтобы добавить дополнительную функциональность. Например, методы модели могут выполнять валидацию данных перед сохранением или предоставлять дополнительные свойства для работы с данными.

**Пример:**

```Python
# my_app/models.py
from django.db import models


class Person(models.Model):
    name = models.CharField(max_length=255)
    age = models.IntegerField()
```

**В этом примере:**

- `Person` – имя модели.
- `name` – поле модели типа `CharField` (строка) с максимальной длиной 255 символов.
- `age` – поле модели типа `IntegerField` (целое число).

### Часто используемые типы полей

|   |   |   |
|---|---|---|
|**Тип поля**|**Описание**|**Особенности**|
|`CharField`|Строка фиксированной длины.|Подходит для хранения коротких строк, таких как имена, коды и т.д. Максимальная длина строки задается с помощью **обязательного** атрибута `max_length`|
|`TextField`|Строка неограниченной длины.|Подходит для хранения длинных текстов, таких как описания, статьи и т.д. Не имеет ограничения на длину.|
|`IntegerField`|Целое число.|Подходит для хранения целых чисел. Может быть использован для счетчиков, идентификаторов и т.д.|
|`BooleanField`|Булево значение (True/False).|Подходит для хранения булевых значений (True/False). Может быть использован для флагов, индикаторов и т.д.|
|`DateTimeField`|Дата и время.|Подходит для хранения даты и времени. Может быть использован для отслеживания времени создания, изменения и т.д.|
|`DateField`|Дата.|Подходит для хранения даты. Может быть использован для дат рождения, дат событий и т.д.|
|`TimeField`|Время.|Подходит для хранения времени. Может быть использован для времени начала работы, времени закрытия и т.д.|
|`DecimalField`|Десятичное число.|Подходит для хранения десятичных чисел. Может быть использован для цен, валютных курсов и т.д.|
|`EmailField`|Адрес электронной почты.|Подходит для хранения адресов электронной почты. Обеспечивает проверку валидности адреса.|
|`FileField`|Файл.|Подходит для хранения файлов. Файлы хранятся на сервере.|
|`ForeignKey`|Связь с другой моделью.|Подходит для связи с другой моделью. Связь может быть один-к-одному или один-ко-многим.|
|`ManyToManyField`|Связь с множеством других моделей.|Подходит для связи с множеством других моделей. Связь может быть многие-ко-многим.|
|`AutoField`|Автоматический первичный ключ.|Автоматически генерирует уникальный номер для каждой записи. Используется в качестве первичного ключа. Обычно вам не нужно использовать это поле, так как поле первичного ключа будет автоматически добавлено в вашу модель, если вы не укажете иное.|
|`SlugField`|"Слаг" (упрощенный вариант текста).|Подходит для хранения "слага" (упрощенного варианта текста). "Слаг" используется в URL-адресах.|
|`URLField`|URL-адрес.|Подходит для хранения URL-адресов. Обеспечивает проверку валидности URL-адреса.|

### Часто используемые аргументы полей

|   |   |
|---|---|
|`max_length`|Максимальная длина строки (для CharField).|
|`blank`|Может ли поле быть пустым (True/False).|
|`null`|Может ли поле хранить значение NULL (True/False).|
|`default`|Значение по умолчанию для поля.|
|`on_delete`|Действие, которое выполняется при удалении связанной модели (для ForeignKey).|
|`primary_key`|Является ли поле первичным ключом (True/False).|
|`auto_now`|Автоматически обновляет поле текущей датой и временем каждый раз, когда модель сохраняется (для DateTimeField).|
|`auto_now_add`|Автоматически устанавливает поле в текущую дату и время только при первом сохранении модели (для DateTimeField).|
<div class="page-break" style="page-break-before: always;"></div>
