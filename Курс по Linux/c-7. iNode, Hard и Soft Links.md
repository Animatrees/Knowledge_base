**Файл** - это область данных на диске, к которой можно обратиться через его имя.

**Индексный дескриптор (inode)** - это структура данных в файловых системах UNIX, включая Linux, которая содержит метаданные о файле или каталоге. Каждый файл в файловой системе UNIX/Linux связан с одним индексным дескриптором, который идентифицирует и хранит информацию о файле.

Индексный дескриптор (inode) обычно содержит следующую информацию:

1. **Номер индексного дескриптора (inode number):** Уникальный числовой идентификатор, который однозначно идентифицирует индексный дескриптор в пределах файловой системы.
2. **Размер файла:** Количество байтов данных в файле.
3. **Тип файла:** Определяет, является ли объект обычным файлом, директорией, символической ссылкой, устройством и так далее.
4. **Права доступа:** Управляют правами доступа к файлу для владельца, группы и остальных пользователей.
5. **Число жёстких ссылок:** Количество жёстких ссылок, указывающих на данный индексный дескриптор. Когда создается жёсткая ссылка на файл, увеличивается это число.
6. **Идентификатор пользователя и группы владельца:** UID и GID владельца файла.
7. **Временные метки:** Время создания, последней модификации и последнего доступа к файлу.
8. **Блоки данных:** Ссылки на блоки данных, содержащие фактические данные файла. Для небольших файлов, прямые ссылки используются для хранения данных. Для больших файлов могут использоваться косвенные ссылки, дважды косвенные ссылки и так далее.

Команда `**ls -li**` в Linux используется для отображения индексных дескрипторов (inodes) вместе с другой информацией о файлах и директориях в текущей директории. Вот разбор ключей и вывода этой команды:

- `**l**` **(длинный формат):** Этот ключ указывает на вывод информации в длинном формате, что включает в себя дополнительные детали о файлах, такие как права доступа, количество жёстких ссылок, владелец, группа, размер, время и имя файла.
- `**i**` **(индексные дескрипторы):** Этот ключ добавляет вывод номеров индексных дескрипторов (inodes) в начало каждой строки вывода.

Пример вывода команды `**ls -li**`:

```Shell
134256 -rw-r--r-- 1 user1 users 4096 Jan 1 12:34 example.txt
134257 drwxr-xr-x 2 user1 users 4096 Jan 1 12:34 my_directory
134258 lrwxrwxrwx 1 user1 users   10 Jan 1 12:34 symbolic_link -> target_file
```

Каждая строка представляет файл или директорию и содержит следующую информацию:

1. Номер индексного дескриптора - inode (например, `134256`).
2. Следующий столбец указывает на тип файла и права доступа к файлу или директории.
3. После прав доступа идет число жёстких ссылок на файл.
4. Информация о владельце или группе владельца.
5. Размер файла или директории в байтах.
6. Дата и время последней модификации.
7. Имя файла или директории.

### **Жёсткие ссылки (Hard Links)**

1. Жёсткая ссылка — это дополнительное имя (путь) к существующему файлу в файловой системе. Оба исходный файл и его жёсткие ссылки считаются равноправными, и нет способа отличить оригинал от его копий по жёстким ссылкам.
2. **Особенности:**
    - Все жёсткие ссылки на один и тот же файл имеют одинаковый номер индексного дескриптора (inode).
    - Удаление жёсткой ссылки не влияет на остальные ссылки на этот файл, и сам файл останется в системе, пока существует хотя бы одна жёсткая ссылка.
    - Внутренняя структура большинства файловых систем не позволяет жёстким ссылкам указывать на директории. Это связано с тем, что директории содержат структуру каталога, которая хранит имена файлов и связанные с ними индексные дескрипторы.
        
        Разрешение наличия жёстких ссылок на директории создало бы потенциальные проблемы с целостностью структуры каталога и могло бы привести к созданию циклических или сложных зависимостей.
        
3. **Пример создания:**
    
    ```Shell
    ln source_file hard_link
    ```
    

### **Мягкие ссылки (Symbolic Links или Symlinks)**

1. Мягкая ссылка, или символическая ссылка, представляет собой отдельный файл, который содержит путь к другому файлу в файловой системе. Она создаёт альтернативное имя для файла, указывая на его расположение.
2. **Особенности:**
    - Мягкие ссылки могут указывать на файлы или директории, которые находятся в других файловых системах.
    - Если исходный файл удалён, мягкая ссылка становится «битой» и не имеет назначения.
    - Мягкая ссылка имеет свой собственный номер индексного дескриптора (inode), и её размер обычно небольшой.
3. **Пример создания:**
    
    ```Shell
    ln -s source_file symbolic_link
    ```
    

**Разница между жёсткими и мягкими ссылками:**

- **Индексный дескриптор (inode):** У жёстких ссылок общий inode с оригиналом, у мягких ссылок свой собственный inode.
- **Пересечение файловых систем:** Мягкая ссылка может иметь цель (то, на что она указывает) вне текущей файловой системы.
    
    Это свойство мягких ссылок является отличием от жёстких ссылок, которые привязаны к индексному дескриптору (inode) в пределах одной и той же файловой системы. Жёсткие ссылки не могут пересекать границы файловых систем.
    

### Удаление ссылок

Когда последняя жёсткая ссылка удаляется, система уменьшает счётчик жёстких ссылок у индексного дескриптора файла. Если счётчик достигает нуля, система освобождает ресурсы, занимаемые этим файлом, такие как блоки данных и сам индексный дескриптор. Это позволяет операционной системе использовать эти ресурсы для других файлов.

Процесс удаления файла из файловой системы полностью зависит от системы и реализации файловой системы. В большинстве случаев файл фактически удаляется, когда все его ссылки (включая мягкие ссылки) удаляются и нет процессов, работающих с этим файлом.
<div class="page-break" style="page-break-before: always;"></div>
